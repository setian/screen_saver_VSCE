# 코딩 화면 보호기 - 개발 로그

이 문서는 VS Code 확장 프로그램 "코딩 화면 보호기"의 아이디어 구상부터 기능 개발, 버그 수정, 개선에 이르기까지 Gemini와 사용자 간의 전체 개발 과정을 기록한 대화 로그입니다.

---

### 1. 초기 아이디어와 프로젝트 설정

**User:** VS Code 확장 프로그램으로 화면 보호기를 만들려고 합니다.

**Gemini:** 좋은 아이디어입니다! 현재 프로젝트는 "Wake Up Alarm"(반복 키 입력 시 알람) 기능으로 되어 있네요. 이 기반을 수정하여, 일정 시간 활동이 없으면 화면 보호기가 나타나는 기능으로 개발하는 것을 제안합니다.

**User:** 제가 생각한 아이디어는 이렇습니다:
1. VS Code 창이 활성화된 상태에서만 동작해야 합니다.
2. 이 상태로 일정 시간 활동이 없거나, 기존처럼 특정 키가 반복 입력되면 화면 보호기가 켜집니다.
3. 화면 보호기는 실제 코드를 타이핑하는 듯한 애니메이션을 보여줍니다.

**Gemini:** 훌륭한 컨셉입니다. 타이핑 애니메이션은 실제 파일에 영향을 주지 않는 웹뷰(Webview) 방식으로 구현하는 것이 안전하고 유연합니다. "매트릭스/해커" 스타일의 애니메이션을 제안합니다.

**User:** 사용자의 현재 VS Code 테마나 사용 언어에 맞춰 애니메이션이 바뀌는 것은 어떤가요?

**Gemini:** 좋은 지적입니다. 언어를 감지하는 것은 `languageId` API를 통해 가능하지만, 테마의 모든 색상을 가져오는 것은 기술적으로 매우 어렵습니다. 따라서, 먼저 핵심 기능을 구현한 뒤 언어 감지 기능을 추가하는 단계적 접근을 제안합니다.

---

### 2. 핵심 기능 구현 (1차)

**Gemini:** `package.json`과 `src/extension.ts` 파일을 수정하여, "활동 없음"과 "반복 입력" 두 가지 조건으로 화면 보호기를 띄우는 핵심 로직을 구현합니다.

*Gemini가 `package.json`과 `src/extension.ts`를 수정하여 기본 로직을 구현함.*

**User:** 빌드 중 `Unterminated string literal` 에러가 발생합니다.

**Gemini:** 죄송합니다. 코드 생성 중 특수문자(`\n`) 처리 실수입니다. 즉시 수정하겠습니다.

*Gemini가 `src/extension.ts`의 문자열 오류를 수정함.*

---

### 3. GitHub Gist 연동 기능 추가

**User:** GitHub의 코드 조각(Gist)을 가져와서 보여줄 수 있나요? 다른 사람들의 Gist를 무작위로 가져오면 좋겠습니다.

**Gemini:** 훌륭한 아이디어입니다! GitHub API를 통해 공개 Gist를 가져와서 보여주도록 기능을 확장하겠습니다. 사용자가 보고 있는 파일의 언어에 맞춰 Gist를 필터링하는 기능도 추가합니다.

**User:** Gist가 계속 반복해서 나타나는 것 같습니다. 그리고 C언어나 루비는 잘 못 찾는 것 같네요.

**Gemini:** 정확한 지적입니다. 현재 최근 Gist 100개만 확인하고 있어서 그렇습니다. 검색 범위를 1000개로 늘려서 희소 언어의 Gist를 찾을 확률을 높이고, 캐싱(Caching) 시스템을 도입하여 GitHub API 요청 횟수 제한 문제를 해결할 것을 제안합니다.

**User:** 좋습니다. 그렇게 수정해 주세요.

*Gemini가 `src/extension.ts`를 수정하여 Gist 1000개 검색 및 캐싱 기능을 추가함.*

---

### 4. 애니메이션 및 UX 개선

**User:** 화면이 단색이라 실제 VS Code처럼 알록달록하지 않습니다.

**Gemini:** `highlight.js` 라이브러리를 사용하여 구문 강조(Syntax Highlighting) 기능을 추가하겠습니다. 타이핑이 끝나면 코드가 화려하게 바뀔 겁니다.

**User:** 여전히 Pluto 이미지가 보이고, API 에러가 발생합니다.

**Gemini:** 이전 버전의 빌드 캐시 문제로 보입니다. 프로젝트 "대청소"(`out`, `node_modules` 삭제 후 재설치)를 통해 해결합니다.

*Gemini가 프로젝트 클린 및 재설치, 재빌드를 진행함.*

**User:** API 요청 횟수 제한에 걸렸을 때를 대비해, 에러 대신 보여줄 기본 코드를 3개 정도 준비하고 반복해서 보여주세요.

**Gemini:** 좋은 안전장치입니다. JS(매트릭스), Python(퀵 정렬), C(문자열 뒤집기) 3가지 코드를 폴백(Fallback)으로 추가하겠습니다.

*Gemini가 `src/extension.ts`에 폴백 코드와 관련 로직을 추가하는 과정에서, 두 번의 빌드 오류(`$` 및 `\` 문자열 처리 오류)를 일으키고 사과 후 수정함.*

**User:** 마지막 피드백입니다:
1. 두 번째 Gist부터는 색깔이 적용되지 않습니다.
2. 코드가 길어지면 자동 스크롤이 필요합니다.
3. 타이핑 속도가 너무 빠릅니다.

**Gemini:** 모두 수정하겠습니다. `media/webview.html`의 애니메이션 로직을 개선하여 세 가지 문제를 한 번에 해결합니다.

**User:** 타이핑이 끝난 후에 색이 입혀지는데, 작성되는 과정부터 알록달록하게 보였으면 합니다.

**Gemini:** 매우 정교한 작업이지만 도전해 보겠습니다. 애니메이션 로직을 완전히 새로 구현하여, 색깔 있는 글자가 한 글자씩 타이핑되는 것처럼 만들겠습니다.

*Gemini가 `media/webview.html`의 애니메이션 로직을 대폭 수정함.*

**User:** 이제는 오히려 이상합니다. 색깔이 아예 안 보입니다.

**Gemini:** 죄송합니다. 복잡한 로직을 구현하며 색상 정보를 누락하는 실수가 있었습니다. 다시 수정하겠습니다.

**User:** 코드가 채워질 공간이 미리 보여서 어색합니다.

**Gemini:** 예리한 지적입니다. 글자를 숨기는 CSS 속성을 `visibility: hidden`에서 `display: none`으로 변경하여 공간을 차지하지 않도록 수정합니다.

*Gemini가 `media/webview.html`을 마지막으로 수정함.*

**User:** `Cannot read properties of undefined (reading 'webview')` 런타임 에러가 발생합니다.

**Gemini:** 레이스 컨디션 문제입니다. 화면 보호기 패널이 사라진 후에 비동기 작업이 완료되어 발생하는 문제입니다. 패널이 존재하는지 확인하는 안전장치를 추가하여 최종적으로 문제를 해결합니다.

*Gemini가 `src/extension.ts`에 안전 코드를 추가하여 모든 개발을 완료함.*

---

**최종 결과물:**
- 유휴 시간 또는 반복된 키 입력으로 실행
- 현재 작업중인 언어에 맞는 Gist를 GitHub에서 동적으로 로드 (1000개 중 검색)
- Gist 로드 실패 시, 3가지 기본 코드를 순환하여 보여주는 강력한 폴백 기능
- 15분 단위의 캐싱으로 API 요청 제한 문제 해결
- 타이핑 과정부터 구문 강조가 적용되는 자연스러운 애니메이션
- 자동 스크롤 기능
- 모든 알려진 버그 및 레이스 컨디션 해결
